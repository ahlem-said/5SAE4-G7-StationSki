pipeline{
    agent any
    stages {
        //  stage('Git') {
         //      steps {
       //            // Étape pour récupérer le code source depuis le référentiel Git
       //            checkout scm
        //       }
        //   }
        stage(" Maven Test "){
            steps {
                sh "mvn -version"
            }
        }
        stage("JDK Test "){
            steps {
                sh "java -version"
            }
        }
        stage("Getting Projet From Git"){
            steps {
                echo "Pulling"
            }
        }
        stage('Cleaning & Compiling') {
            steps{
                sh 'mvn clean compile'

        }
          }

          stage('SonarQube CodeQuality Check') {
                      steps{
                          sh 'mvn sonar:sonar -Dsonar.login=admin -Dsonar.password=adminsonar'
                      }
                  }
            stage('Unit Test') {
                       steps {
                           // Use Maven to run JUnit tests
                           sh 'mvn test'
                       }
                   }

             //stage('Publish to Nexus') {
              //          steps {
               //             script {
               //                 def nexusUrl = 'http://localhost:8081/repository/maven-releases/' // Remplacez par l'URL de votre serveur Nexus
                //                def nexusCredentialsId = 'nexus-credentials' // ID des identifiants Nexus dans Jenkins

                 //               def artifactsToPublish = [
                 //                   [
                  //                      repository: 'Nexus Repository',
                    //                ]
                   //             ]

                      //          nexusArtifactUploader artifacts: artifactsToPublish, credentialsId: nexusCredentialsId, nexusUrl: nexusUrl
                     //       }
                      //  }
                   // }

                    stage('Deploy to Nexus') {
                              steps {
                                           {
                                       sh 'mvn deploy -DaltDeploymentRepository=deploymentRepo::default::http://localhost:8081/repository/maven-releases/ -Dnexus.user=admin -Dnexus.password=nexus'
                                    }
                                }
                       }

                     //  stage('Publish to Nexus') {
                     //              steps {
                      //                 script {
                      //                     def nexusUrl = 'http://localhost:8081/repository/maven-releases/' // Remplacez par l'URL de votre serveur Nexus
                      //                     def nexusCredentialsId = 'nexusCredentialsId' // ID des identifiants Nexus dans Jenkins

                        //                   def deployCommand = 'mvn deploy -DskipTests' // Commande Maven pour déployer en skippant les tests
                        //               }
                         //          }
                         //      }
    }
}